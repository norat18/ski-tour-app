<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ski Tour Decision - PNW Backcountry</title>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;600;700&family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --cream: #F5F1E8;
            --burnt-orange: #D6622C;
            --forest-green: #2C5530;
            --dark-green: #1A3320;
            --steel-blue: #5B7C99;
            --warning-red: #C14236;
            --snow-white: #FDFCFA;
            --topo-gray: #8A8478;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Archivo', sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, #E8DCC8 100%);
            color: var(--dark-green);
            min-height: 100vh;
            padding: 2rem;
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 49px, rgba(42, 85, 48, 0.03) 49px, rgba(42, 85, 48, 0.03) 50px),
                repeating-linear-gradient(90deg, transparent, transparent 49px, rgba(42, 85, 48, 0.03) 49px, rgba(42, 85, 48, 0.03) 50px);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        header {
            background: linear-gradient(135deg, var(--forest-green) 0%, var(--dark-green) 100%);
            padding: 2rem 2.5rem;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--burnt-orange), var(--warning-red), var(--burnt-orange));
        }

        h1 {
            color: var(--snow-white);
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: -0.5px;
            margin-bottom: 0.5rem;
        }

        .location {
            color: var(--cream);
            font-family: 'Courier Prime', monospace;
            font-size: 0.95rem;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .setup-panel {
            background: var(--snow-white);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        }

        .setup-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--forest-green);
            margin-bottom: 1.5rem;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-label {
            display: block;
            font-weight: 600;
            color: var(--dark-green);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .input-sublabel {
            display: block;
            font-size: 0.8rem;
            color: var(--topo-gray);
            margin-bottom: 0.5rem;
        }

        input[type="text"], select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--cream);
            border-radius: 6px;
            font-family: 'Courier Prime', monospace;
            font-size: 0.9rem;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: var(--forest-green);
        }

        .btn {
            background: var(--forest-green);
            color: white;
            padding: 0.875rem 2rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            background: var(--dark-green);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(44, 85, 48, 0.3);
        }

        .btn:disabled {
            background: var(--topo-gray);
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--topo-gray);
            font-size: 1.1rem;
        }

        .spinner {
            border: 4px solid var(--cream);
            border-top: 4px solid var(--forest-green);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #FFE5E5;
            color: var(--warning-red);
            padding: 1rem;
            border-radius: 6px;
            border-left: 4px solid var(--warning-red);
            margin-bottom: 1rem;
        }

        .date-banner {
            background: var(--burnt-orange);
            color: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 2rem;
            font-weight: 600;
            font-size: 1.1rem;
            box-shadow: 0 4px 12px rgba(214, 98, 44, 0.3);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background: var(--snow-white);
            border-radius: 10px;
            padding: 1.75rem;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            border: 2px solid rgba(44, 85, 48, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.25rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--cream);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--forest-green);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .danger-level {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .danger-low {
            background: #90EE90;
            color: #006400;
        }

        .danger-moderate {
            background: #FFB84D;
            color: #664400;
        }

        .danger-considerable {
            background: var(--burnt-orange);
            color: white;
        }

        .danger-high {
            background: var(--warning-red);
            color: white;
        }

        .weather-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .weather-item {
            background: var(--cream);
            padding: 1rem;
            border-radius: 6px;
            text-align: center;
        }

        .weather-label {
            font-size: 0.8rem;
            color: var(--topo-gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .weather-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--forest-green);
            font-family: 'Courier Prime', monospace;
        }

        .fitness-slider {
            margin-top: 1.5rem;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--topo-gray);
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            background: linear-gradient(to right, var(--warning-red) 0%, #FFB84D 50%, var(--forest-green) 100%);
            border-radius: 4px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: var(--dark-green);
            border: 3px solid white;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: var(--dark-green);
            border: 3px solid white;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .fitness-status {
            text-align: center;
            margin-top: 1rem;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--forest-green);
        }

        .tours-section {
            margin-top: 2rem;
        }

        .tour-card {
            background: var(--snow-white);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            border-left: 6px solid var(--forest-green);
            transition: all 0.3s ease;
        }

        .tour-card:hover {
            transform: translateX(8px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.12);
        }

        .tour-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }

        .tour-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--forest-green);
            margin-bottom: 0.5rem;
        }

        .tour-stats {
            font-family: 'Courier Prime', monospace;
            color: var(--topo-gray);
            font-size: 0.9rem;
        }

        .recommendation {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.95rem;
            min-width: 140px;
            text-align: center;
        }

        .rec-go {
            background: var(--forest-green);
            color: white;
        }

        .rec-maybe {
            background: #FFB84D;
            color: #664400;
        }

        .rec-no {
            background: var(--warning-red);
            color: white;
        }

        .tour-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            padding: 1.5rem;
            background: var(--cream);
            border-radius: 8px;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .detail-icon {
            font-size: 1.5rem;
        }

        .detail-text {
            font-size: 0.9rem;
        }

        .detail-label {
            color: var(--topo-gray);
            display: block;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            font-weight: 600;
            color: var(--dark-green);
        }

        .footer {
            margin-top: 3rem;
            text-align: center;
            color: var(--topo-gray);
            font-size: 0.85rem;
            padding: 2rem;
            background: rgba(255,255,255,0.5);
            border-radius: 8px;
        }

        .footer a {
            color: var(--forest-green);
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        #setupPanel {
            display: block;
        }

        /* #appContent is always visible - children control their own display */

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .weather-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tour-header {
                flex-direction: column;
                gap: 1rem;
            }
            
            .recommendation {
                width: 100%;
            }
        }

        .zone-selector-header {
            margin-top: 1rem;
        }

        .zone-selector-header select {
            width: 100%;
            max-width: 400px;
            padding: 0.75rem 1rem;
            font-size: 1.1rem;
            font-weight: 600;
            border: 2px solid var(--forest-green);
            border-radius: 8px;
            background: white;
            color: var(--forest-green);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .zone-selector-header select:hover {
            background: var(--cream);
        }

        .zone-selector-header select:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(45, 80, 45, 0.2);
        }

        .welcome-message {
            text-align: center;
            padding: 4rem 2rem;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin: 2rem 0;
        }

        .welcome-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .welcome-message h2 {
            color: var(--forest-green);
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .welcome-message p {
            color: var(--topo-gray);
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .welcome-message ul {
            list-style: none;
            padding: 0;
        }

        .welcome-message li {
            padding: 0.5rem 0;
            color: var(--topo-gray);
        }

        .welcome-message li::before {
            content: "‚úì ";
            color: var(--forest-green);
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚õ∑Ô∏è Ski Tour Decision Dashboard</h1>
            <div class="zone-selector-header">
                <select id="nwacZone" onchange="onZoneChange()">
                    <option value="">Choose your zone...</option>
                    <optgroup label="Washington Cascades - West">
                        <option value="west-slopes-north">West Slopes North (Mt Baker)</option>
                        <option value="stevens-pass">Stevens Pass</option>
                        <option value="west-slopes-central">West Slopes Central</option>
                        <option value="snoqualmie-pass">Snoqualmie Pass</option>
                        <option value="west-slopes-south">West Slopes South (White Pass)</option>
                    </optgroup>
                    <optgroup label="Washington Cascades - East">
                        <option value="east-slopes-north">East Slopes North</option>
                        <option value="east-slopes-central">East Slopes Central (Mission Ridge)</option>
                        <option value="east-slopes-south">East Slopes South</option>
                    </optgroup>
                    <optgroup label="Other Areas">
                        <option value="olympics">Olympics</option>
                        <option value="mt-hood">Mt Hood</option>
                    </optgroup>
                </select>
            </div>
        </header>

        <!-- Main App Content -->
        <div id="appContent">
            <!-- Welcome message shown before zone selection -->
            <div id="welcomeMessage" class="welcome-message">
                <div class="welcome-icon">üèîÔ∏è</div>
                <h2>Welcome, Ski Tourer!</h2>
                <p>Select your zone above to get personalized tour recommendations based on:</p>
                <ul style="text-align: left; max-width: 300px; margin: 1rem auto;">
                    <li>Current avalanche conditions</li>
                    <li>Today's weather forecast</li>
                    <li>Your energy level</li>
                    <li>Your touring skill</li>
                </ul>
            </div>

            <!-- Dashboard content (hidden until zone selected) -->
            <div id="dashboardContent" style="display: none;">
                <div class="date-banner" id="dateBanner">
                    üìÖ Loading...
                </div>

                <div class="dashboard">
                    <!-- Avalanche Card -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">üèîÔ∏è Avalanche Forecast</div>
                        </div>
                        <div id="avalancheContent">
                            <div class="loading">
                                <div class="spinner"></div>
                                Loading avalanche forecast...
                            </div>
                        </div>
                    </div>

                    <!-- Weather Card -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">‚õÖ Weather</div>
                        </div>
                        <div id="weatherContent">
                            <div class="loading">
                                <div class="spinner"></div>
                                Loading weather data...
                            </div>
                        </div>
                    </div>

                    <!-- Fitness Card -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">üí™ How I'm Feeling Today</div>
                        </div>
                        <div class="fitness-slider">
                            <div class="slider-label">
                                <span>Exhausted</span>
                                <span>Peak Energy</span>
                            </div>
                            <input type="range" id="fitnessSlider" min="1" max="10" value="7" step="1">
                            <div class="fitness-status" id="fitnessStatus">Strong (7/10)</div>
                        </div>
                        <p style="margin-top: 1rem; font-size: 0.85rem; color: var(--topo-gray); line-height: 1.5;">
                            How's your energy today? Higher = longer, harder tours recommended.
                        </p>
                    </div>

                    <!-- Skill Level Card -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">üéø Touring Skill Level</div>
                        </div>
                        <div class="fitness-slider">
                            <div class="slider-label">
                                <span>Beginner</span>
                                <span>Expert</span>
                            </div>
                            <input type="range" id="skillSlider" min="1" max="10" value="5" step="1">
                            <div class="fitness-status" id="skillStatus">Intermediate (5/10)</div>
                        </div>
                        <p style="margin-top: 1rem; font-size: 0.85rem; color: var(--topo-gray); line-height: 1.5;">
                            Your backcountry experience: skinning, route-finding, avalanche assessment, glacier travel.
                        </p>
                        <div id="skillDescription" style="margin-top: 0.75rem; padding: 0.75rem; background: var(--cream); border-radius: 6px; font-size: 0.8rem; color: var(--topo-gray);">
                            Can handle moderate terrain, some route-finding, comfortable with avalanche basics.
                        </div>
                    </div>
                </div>

                <div class="tours-section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <h2 style="font-size: 2rem; color: var(--forest-green); margin: 0;">üìç Recommended Tours</h2>
                    </div>
                    <p id="toursSortMessage" style="font-size: 0.9rem; color: var(--topo-gray); margin-bottom: 1.5rem; padding: 1rem; background: var(--cream); border-radius: 6px;">
                        üí° Tours sorted by best match for your fitness. Loading...
                    </p>
                    <div id="toursContent">
                        <div class="loading">
                            <div class="spinner"></div>
                            Loading tour options...
                        </div>
                    </div>
                </div>

                <div class="footer">
                    <p>Data sources: <a href="https://nwac.us/" target="_blank">NWAC</a> ‚Ä¢ <a href="https://www.weather.gov/" target="_blank">NWS</a> ‚Ä¢ <a href="https://caltopo.com/" target="_blank">CalTopo</a></p>
                    <p style="margin-top: 0.5rem;">‚ö†Ô∏è This is a decision support tool. Always make your own informed choices in the backcountry.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Default coordinates for each NWAC zone
        const zoneDefaults = {
            'west-slopes-north': { lat: 48.868, lon: -121.813, name: 'Mt Baker Area' },
            'stevens-pass': { lat: 47.745, lon: -121.089, name: 'Stevens Pass' },
            'west-slopes-central': { lat: 47.500, lon: -121.400, name: 'West Slopes Central' },
            'snoqualmie-pass': { lat: 47.424, lon: -121.413, name: 'Snoqualmie Pass' },
            'west-slopes-south': { lat: 46.600, lon: -121.400, name: 'White Pass Area' },
            'east-slopes-north': { lat: 48.500, lon: -120.650, name: 'North Cascades East' },
            'east-slopes-central': { lat: 47.250, lon: -120.650, name: 'Mission Ridge Area' },
            'east-slopes-south': { lat: 47.250, lon: -120.900, name: 'Wenatchee Mountains' },
            'olympics': { lat: 47.900, lon: -123.600, name: 'Olympic Mountains' },
            'mt-hood': { lat: 45.330, lon: -121.710, name: 'Mt Hood' }
        };

        // Configuration
        let config = {
            location: null,
            nwacZone: null,
            caltopoMapId: null,
            fitnessLevel: 7,
            skillLevel: 5
        };

        // Tour database organized by zone
        const toursByZone = {
            'west-slopes-north': [
                { name: "Winchester Mountain and Mount Larrabee", location: "Mt Baker", elevationGain: 7513, distance: 14, maxElevation: 8000, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Tomyhoi Peak", location: "Mt Baker", elevationGain: 3500, distance: 11, maxElevation: 7500, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Goat Mt.", location: "Mt Baker", elevationGain: 3000, distance: 8.8, maxElevation: 6800, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Ruth Mt.", location: "Mt Baker", elevationGain: 4035, distance: 8, maxElevation: 7100, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Skyline Divide", location: "Mt Baker", elevationGain: 2500, distance: 9, maxElevation: 6500, aspect: "Multiple", terrain: "Open slopes, <30¬∞" },
                { name: "Chowder Ridge", location: "Mt Baker", elevationGain: 2800, distance: 10, maxElevation: 6200, aspect: "Multiple", terrain: "Exposed ridge" },
                { name: "Herman Saddle", location: "Mt Baker", elevationGain: 1500, distance: 9, maxElevation: 5400, aspect: "Multiple", terrain: "Open bowls, 30-35¬∞" },
                { name: "Table Mountain Circumnav", location: "Mt Baker", elevationGain: 1900, distance: 5, maxElevation: 5742, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Stoneman Couloir", location: "Mt Baker", elevationGain: 3020, distance: 5.5, maxElevation: 6000, aspect: "Multiple", terrain: "Couloir, 40-50¬∞" },
                { name: "Mount Ann", location: "Mt Baker", elevationGain: 2500, distance: 9, maxElevation: 5900, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Coleman Pinnacle", location: "Mt Baker", elevationGain: 2800, distance: 9, maxElevation: 6400, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Sholes Glacier", location: "Mt Baker", elevationGain: 3000, distance: 9, maxElevation: 6500, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Coleman Glacier", location: "Mt Baker", elevationGain: 7111, distance: 11, maxElevation: 10781, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Mount Shuksan: North Face", location: "Mt Baker", elevationGain: 6280, distance: 10, maxElevation: 9131, aspect: "Multiple", terrain: "Glacier travel, 40-50¬∞" },
                { name: "Mount Shuksan: White Salmon Glacier", location: "Mt Baker", elevationGain: 6600, distance: 11, maxElevation: 9131, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Mt Shuksan", location: "Mt Baker", elevationGain: 5000, distance: 12, maxElevation: 9131, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Mount Baker: Park Glacier", location: "Mt Baker", elevationGain: 9600, distance: 20, maxElevation: 10781, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Mt Baker: Easton Glacier", location: "Mt Baker", elevationGain: 7000, distance: 12, maxElevation: 10781, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Colfax Peak: South Couloir", location: "Mt Baker", elevationGain: 6100, distance: 10, maxElevation: 9400, aspect: "Multiple", terrain: "Couloir, 40-50¬∞" },
                { name: "Mt. Baker: Boulder Glacier", location: "Mt Baker", elevationGain: 8040, distance: 16, maxElevation: 10781, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Pickets Traverse", location: "North Cascades", elevationGain: 25000, distance: 50, maxElevation: 8200, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Park Butte", location: "Mt Baker", elevationGain: 2000, distance: 8, maxElevation: 5450, aspect: "Multiple", terrain: "Open slopes, <30¬∞" },
                { name: "Twin Sisters", location: "Mt Baker", elevationGain: 2500, distance: 7, maxElevation: 6932, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Mt. Watson", location: "North Cascades", elevationGain: 2500, distance: 10, maxElevation: 6200, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Bacon Peak", location: "North Cascades", elevationGain: 4500, distance: 17, maxElevation: 7066, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Ruby Mountain", location: "North Cascades", elevationGain: 5230, distance: 8, maxElevation: 7408, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Neve Glacier", location: "North Cascades", elevationGain: 4000, distance: 11, maxElevation: 8000, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Isolation Traverse", location: "North Cascades", elevationGain: 13000, distance: 28, maxElevation: 8200, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Teebone Ridge", location: "North Cascades", elevationGain: 4500, distance: 14, maxElevation: 7200, aspect: "Multiple", terrain: "Exposed ridge" },
                { name: "Forbidden Tour", location: "North Cascades", elevationGain: 10315, distance: 28, maxElevation: 8800, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Mt. Buckner: North Face", location: "North Cascades", elevationGain: 9300, distance: 20, maxElevation: 9112, aspect: "Multiple", terrain: "Glacier travel, 40-50¬∞" },
                { name: "Eldorado", location: "North Cascades", elevationGain: 5500, distance: 12, maxElevation: 8868, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Sauk Mt", location: "North Cascades", elevationGain: 2000, distance: 6, maxElevation: 5541, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Hidden Lake Peaks", location: "North Cascades", elevationGain: 4689, distance: 8, maxElevation: 7088, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Boston Basin", location: "North Cascades", elevationGain: 3500, distance: 8, maxElevation: 8065, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Sahale Arm/Peak", location: "North Cascades", elevationGain: 5440, distance: 12, maxElevation: 8680, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Cascade-Johannesburg Couloir", location: "North Cascades", elevationGain: 3160, distance: 7, maxElevation: 8200, aspect: "Multiple", terrain: "Couloir, 40-50¬∞" },
                { name: "Snowking Mt", location: "North Cascades", elevationGain: 4000, distance: 12, maxElevation: 7433, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Spider Mountain: North Face", location: "North Cascades", elevationGain: 9980, distance: 16, maxElevation: 8300, aspect: "Multiple", terrain: "Exposed couloirs, 40-50¬∞" },
                { name: "Ptarmigan Traverse", location: "North Cascades", elevationGain: 14000, distance: 40, maxElevation: 8200, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Dome Peak", location: "North Cascades", elevationGain: 8500, distance: 36, maxElevation: 8920, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Whitehorse Mt.", location: "North Cascades", elevationGain: 5925, distance: 8, maxElevation: 6852, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" }
            ],
            'stevens-pass': [
                // Tours accessed directly from Highway 2 near Stevens Pass
                { name: "Cowboy Mt.", location: "Stevens Pass", elevationGain: 1500, distance: 1.5, maxElevation: 5850, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Skyline Ridge", location: "Stevens Pass", elevationGain: 2900, distance: 3, maxElevation: 5978, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Big Chief Mt.", location: "Stevens Pass", elevationGain: 3200, distance: 7, maxElevation: 6440, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Lichtenberg Mt", location: "Stevens Pass", elevationGain: 2700, distance: 8, maxElevation: 5844, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Union Peak", location: "Stevens Pass", elevationGain: 2600, distance: 11, maxElevation: 6200, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Jove Peak", location: "Stevens Pass", elevationGain: 2500, distance: 10, maxElevation: 6007, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Yodelin", location: "Stevens Pass", elevationGain: 2000, distance: 4, maxElevation: 5400, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Jim Hill Mt.", location: "Stevens Pass", elevationGain: 3130, distance: 8, maxElevation: 6765, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Rock Mt.", location: "Stevens Pass", elevationGain: 3500, distance: 9, maxElevation: 6852, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Mt Mastiff", location: "Stevens Pass", elevationGain: 4000, distance: 9, maxElevation: 7200, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Alpine Lookout", location: "Stevens Pass", elevationGain: 3500, distance: 18, maxElevation: 6250, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Skyline Lake", location: "Stevens Pass", elevationGain: 1400, distance: 4, maxElevation: 5092, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Lanham Lake", location: "Stevens Pass", elevationGain: 1200, distance: 5, maxElevation: 4800, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Josephine Lake", location: "Stevens Pass", elevationGain: 1600, distance: 6, maxElevation: 5000, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Tye Ridge", location: "Stevens Pass", elevationGain: 1800, distance: 4, maxElevation: 5600, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Labyrinth Mountain", location: "Stevens Pass", elevationGain: 2800, distance: 8, maxElevation: 6376, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" }
            ],
            'west-slopes-central': [
                // Glacier Peak Wilderness, Chiwaukum Range, Mountain Loop Highway area
                { name: "Mt. Maude", location: "Entiat Mountains", elevationGain: 8400, distance: 14, maxElevation: 9082, aspect: "Multiple", terrain: "Exposed ridge, 40-45¬∞" },
                { name: "Chiwawa Mt.", location: "Chiwawa River", elevationGain: 5000, distance: 19, maxElevation: 8459, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Glacier Peak (North)", location: "Glacier Peak Wilderness", elevationGain: 8000, distance: 24, maxElevation: 10541, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Glacier Peak (South)", location: "Glacier Peak Wilderness", elevationGain: 12960, distance: 24, maxElevation: 10541, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "North Central Cascades Traverse", location: "Glacier Peak Wilderness", elevationGain: 30290, distance: 60, maxElevation: 10541, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "The Dakobed Traverse", location: "Glacier Peak Wilderness", elevationGain: 17990, distance: 40, maxElevation: 9000, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Clark Mt", location: "Entiat Mountains", elevationGain: 4500, distance: 24, maxElevation: 8600, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Chiwaukum Mts", location: "Chiwaukum Range", elevationGain: 5500, distance: 16, maxElevation: 7200, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Chiwaukum Traverse", location: "Chiwaukum Range", elevationGain: 9800, distance: 24, maxElevation: 7200, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Big Jim Mt", location: "Chiwaukum Range", elevationGain: 4000, distance: 14, maxElevation: 7763, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Green Mountain", location: "Mountain Loop Hwy", elevationGain: 2500, distance: 8, maxElevation: 6500, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Mt Pilchuck", location: "Mountain Loop Hwy", elevationGain: 2650, distance: 4, maxElevation: 5324, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Three Fingers", location: "Mountain Loop Hwy", elevationGain: 4000, distance: 13, maxElevation: 6854, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Vesper Peak", location: "Mountain Loop Hwy", elevationGain: 4150, distance: 6, maxElevation: 6214, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Kyes Peak", location: "Mountain Loop Hwy", elevationGain: 6160, distance: 16, maxElevation: 7280, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Bandit Peak: Black Hole Couloir", location: "Nason Ridge", elevationGain: 5900, distance: 15, maxElevation: 7500, aspect: "Multiple", terrain: "Couloir, 40-50¬∞" },
                { name: "Johnson Ridge", location: "Mountain Loop Hwy", elevationGain: 2500, distance: 11, maxElevation: 6000, aspect: "Multiple", terrain: "Open slopes, <30¬∞" },
                { name: "Rock Mt. to Mt. Mastiff Traverse", location: "Nason Ridge", elevationGain: 7740, distance: 11, maxElevation: 7200, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Arrowhead Mountain", location: "Nason Ridge", elevationGain: 2000, distance: 4.5, maxElevation: 6030, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" }
            ],
            'snoqualmie-pass': [
                { name: "Big Snow Mt.", location: "Snoqualmie Pass", elevationGain: 3500, distance: 15, maxElevation: 6680, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Wedge Mt.", location: "Snoqualmie Pass", elevationGain: 2000, distance: 10, maxElevation: 6000, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Ingalls Peak", location: "Snoqualmie Pass", elevationGain: 3500, distance: 11, maxElevation: 7662, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Mt. Stuart", location: "Snoqualmie Pass", elevationGain: 8185, distance: 14, maxElevation: 9415, aspect: "Multiple", terrain: "Exposed ridge, 40-45¬∞" },
                { name: "Enchantments / Central Cascades Traverse", location: "Snoqualmie Pass", elevationGain: 7250, distance: 50, maxElevation: 8500, aspect: "Multiple", terrain: "Exposed ridge" },
                { name: "Cashmere Mt.", location: "Snoqualmie Pass", elevationGain: 5000, distance: 18, maxElevation: 8501, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Icicle Ridge", location: "Snoqualmie Pass", elevationGain: 3000, distance: 14, maxElevation: 6500, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Cannon Mountain Couloir", location: "Snoqualmie Pass", elevationGain: 5620, distance: 8.5, maxElevation: 8638, aspect: "Multiple", terrain: "Couloir, 40-50¬∞" },
                { name: "Colchuck Peak / Porcupine Creek", location: "Snoqualmie Pass", elevationGain: 6705, distance: 22, maxElevation: 8705, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Dragontail Peak", location: "Snoqualmie Pass", elevationGain: 5500, distance: 14, maxElevation: 8840, aspect: "Multiple", terrain: "Exposed couloirs, 40-45¬∞" },
                { name: "Mt. Daniel", location: "Snoqualmie Pass", elevationGain: 5380, distance: 14, maxElevation: 7986, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Jolly Mt.", location: "Snoqualmie Pass", elevationGain: 2500, distance: 12, maxElevation: 6443, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Howson Creek", location: "Snoqualmie Pass", elevationGain: 1500, distance: 6, maxElevation: 4800, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Forest Road 800", location: "Snoqualmie Pass", elevationGain: 800, distance: 6, maxElevation: 3800, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "Hog Loppet", location: "Snoqualmie Pass", elevationGain: 1200, distance: 21, maxElevation: 4200, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "Mission Peak", location: "Snoqualmie Pass", elevationGain: 1000, distance: 2, maxElevation: 6876, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Haney Meadow", location: "Snoqualmie Pass", elevationGain: 2000, distance: 9, maxElevation: 5500, aspect: "Multiple", terrain: "Open slopes, <30¬∞" },
                { name: "Diamond Head", location: "Snoqualmie Pass", elevationGain: 2200, distance: 5, maxElevation: 5915, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Tronsen Meadows", location: "Snoqualmie Pass", elevationGain: 800, distance: 3, maxElevation: 4600, aspect: "Multiple", terrain: "Open meadow, <25¬∞" },
                { name: "Mt. Thompson", location: "Snoqualmie Pass", elevationGain: 4000, distance: 16, maxElevation: 6554, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Snoqualmie Haute Route", location: "Snoqualmie Pass", elevationGain: 20000, distance: 50, maxElevation: 8500, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Little Snoqualmie Haute Route", location: "Snoqualmie Pass", elevationGain: 8000, distance: 24, maxElevation: 7000, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Overcoat Peak", location: "Snoqualmie Pass", elevationGain: 4000, distance: 9, maxElevation: 6720, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Alaska Mt.", location: "Snoqualmie Pass", elevationGain: 3500, distance: 10, maxElevation: 5800, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Mt. Roosevelt", location: "Snoqualmie Pass", elevationGain: 2500, distance: 6, maxElevation: 5800, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Kaleetan Peak", location: "Snoqualmie Pass", elevationGain: 3500, distance: 7, maxElevation: 6259, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Chair Peak Circumnavigation", location: "Snoqualmie Pass", elevationGain: 4510, distance: 7, maxElevation: 6238, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Chair Peak Basin", location: "Snoqualmie Pass", elevationGain: 2500, distance: 5, maxElevation: 6238, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Pineapple Pass", location: "Snoqualmie Pass", elevationGain: 2000, distance: 4, maxElevation: 5200, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Snow Lake Divide", location: "Snoqualmie Pass", elevationGain: 2500, distance: 4, maxElevation: 5400, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Mt. Snoqualmie", location: "Snoqualmie Pass", elevationGain: 4000, distance: 6, maxElevation: 6278, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Kendall Peak", location: "Snoqualmie Pass", elevationGain: 2000, distance: 4, maxElevation: 5784, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Kendall Ridge", location: "Snoqualmie Pass", elevationGain: 2500, distance: 8, maxElevation: 5784, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Lundin Peak", location: "Snoqualmie Pass", elevationGain: 3000, distance: 6, maxElevation: 5920, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Red Mt.", location: "Snoqualmie Pass", elevationGain: 3500, distance: 10, maxElevation: 5890, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Silver Peak", location: "Snoqualmie Pass", elevationGain: 3000, distance: 8, maxElevation: 5605, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Granite Mt.", location: "Snoqualmie Pass", elevationGain: 3800, distance: 8, maxElevation: 5629, aspect: "Multiple", terrain: "Exposed ridge" },
                { name: "Humpback Mt.", location: "Snoqualmie Pass", elevationGain: 2000, distance: 9, maxElevation: 5174, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Mt. Margaret", location: "Snoqualmie Pass", elevationGain: 2500, distance: 15, maxElevation: 5500, aspect: "Multiple", terrain: "Open slopes, <30¬∞" },
                { name: "Mt. Hyak", location: "Snoqualmie Pass", elevationGain: 1000, distance: 2, maxElevation: 5300, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Mt. Catherine", location: "Snoqualmie Pass", elevationGain: 2000, distance: 5, maxElevation: 5052, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Amabilis Mt.", location: "Snoqualmie Pass", elevationGain: 1800, distance: 8, maxElevation: 4554, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "McClellan Butte", location: "Snoqualmie Pass", elevationGain: 3714, distance: 7, maxElevation: 5162, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Keechelus Ridge", location: "Snoqualmie Pass", elevationGain: 1500, distance: 8.4, maxElevation: 5000, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Roaring Ridge", location: "Snoqualmie Pass", elevationGain: 2000, distance: 6, maxElevation: 4800, aspect: "Multiple", terrain: "Treed, <30¬∞" }
            ],
            'west-slopes-south': [
                { name: "Silver King", location: "Mt Rainier", elevationGain: 2000, distance: 5, maxElevation: 5400, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Corral Pass", location: "Mt Rainier", elevationGain: 1500, distance: 12, maxElevation: 5600, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Chinook Pass to Crystal", location: "Mt Rainier", elevationGain: 6000, distance: 9, maxElevation: 7000, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Sheep Lake Couloir", location: "Mt Rainier", elevationGain: 5100, distance: 7, maxElevation: 6600, aspect: "Multiple", terrain: "Couloir, 40-50¬∞" },
                { name: "Norse Peak", location: "Mt Rainier", elevationGain: 2500, distance: 7, maxElevation: 6856, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Union Creek", location: "Mt Rainier", elevationGain: 2000, distance: 9, maxElevation: 6000, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "East Peak", location: "Mt Rainier", elevationGain: 2300, distance: 4, maxElevation: 6260, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Crystal Basin", location: "Mt Rainier", elevationGain: 6300, distance: 6, maxElevation: 7000, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Yakima Peak", location: "Mt Rainier", elevationGain: 1500, distance: 2, maxElevation: 6226, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Naches Peak", location: "Mt Rainier", elevationGain: 1000, distance: 2, maxElevation: 6000, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Bear Gap", location: "Mt Rainier", elevationGain: 1200, distance: 4, maxElevation: 5800, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Summerland", location: "Mt Rainier", elevationGain: 3000, distance: 9, maxElevation: 6500, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Goat Island", location: "Mt Rainier", elevationGain: 2500, distance: 14, maxElevation: 6800, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Cowlitz Chimneys", location: "Mt Rainier", elevationGain: 4300, distance: 13, maxElevation: 7600, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Interglacier", location: "Mt Rainier", elevationGain: 3500, distance: 12, maxElevation: 8200, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Mt Rainier Circumnav", location: "Mt Rainier", elevationGain: 16000, distance: 40, maxElevation: 14411, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Burroughs Mt.", location: "Mt Rainier", elevationGain: 2500, distance: 8, maxElevation: 7800, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Fryingpan Creek Couloir", location: "Mt Rainier", elevationGain: 3600, distance: 7, maxElevation: 7200, aspect: "Multiple", terrain: "Couloir, 40-50¬∞" },
                { name: "Liberty Ridge", location: "Mt Rainier", elevationGain: 11200, distance: 24, maxElevation: 14411, aspect: "Multiple", terrain: "Glacier travel, 40-50¬∞" },
                { name: "Emmons Glacier", location: "Mt Rainier", elevationGain: 10400, distance: 24, maxElevation: 14411, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Carbon Glacier", location: "Mt Rainier", elevationGain: 5000, distance: 10, maxElevation: 10000, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Russell Glacier", location: "Mt Rainier", elevationGain: 4500, distance: 10, maxElevation: 9500, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Puyallap Cleaver", location: "Mt Rainier", elevationGain: 5000, distance: 16, maxElevation: 11000, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Fuhrer Finger", location: "Mt Rainier", elevationGain: 9030, distance: 24, maxElevation: 14411, aspect: "Multiple", terrain: "Couloir, 40-50¬∞" },
                { name: "Muir Snowfield", location: "Mt Rainier", elevationGain: 4660, distance: 9, maxElevation: 10080, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Van Trump Park", location: "Mt Rainier", elevationGain: 6750, distance: 8, maxElevation: 10000, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Golden Gate Bowls", location: "Mt Rainier", elevationGain: 2000, distance: 2.8, maxElevation: 6500, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Nisqually Glacier", location: "Mt Rainier", elevationGain: 5000, distance: 9, maxElevation: 10000, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Alta Vista", location: "Mt Rainier", elevationGain: 800, distance: 1, maxElevation: 5900, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Paradise Glacier", location: "Mt Rainier", elevationGain: 3000, distance: 7, maxElevation: 7500, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Little Tahoma", location: "Mt Rainier", elevationGain: 5718, distance: 10, maxElevation: 11138, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Devil's Dip", location: "Mt Rainier", elevationGain: 600, distance: 2, maxElevation: 5500, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Paradise Valley", location: "Mt Rainier", elevationGain: 400, distance: 0.4, maxElevation: 5400, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Mazama Ridge", location: "Mt Rainier", elevationGain: 1200, distance: 3, maxElevation: 5600, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Edith's Rib", location: "Mt Rainier", elevationGain: 1000, distance: 2.2, maxElevation: 5600, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Reflection Lakes", location: "Mt Rainier", elevationGain: 600, distance: 6.8, maxElevation: 5000, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "Tatoosh Range", location: "Mt Rainier", elevationGain: 3500, distance: 7, maxElevation: 6310, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Tatoosh Traverse", location: "Mt Rainier", elevationGain: 6080, distance: 16, maxElevation: 6310, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Lane Peak: The Zipper", location: "Mt Rainier", elevationGain: 1700, distance: 4, maxElevation: 6013, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "West Side Road", location: "Mt Rainier", elevationGain: 1000, distance: 9.6, maxElevation: 4500, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "Longmire Area", location: "Mt Rainier", elevationGain: 600, distance: 3, maxElevation: 3000, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "White Pass", location: "White Pass", elevationGain: 2000, distance: 6, maxElevation: 5800, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Goat Rocks", location: "White Pass", elevationGain: 5000, distance: 17, maxElevation: 8200, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Forest Rd 1284", location: "White Pass", elevationGain: 1000, distance: 3.5, maxElevation: 4500, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "Goat Rocks: Gilbert Peak", location: "White Pass", elevationGain: 4200, distance: 16, maxElevation: 8201, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "North Fork Tieton River", location: "White Pass", elevationGain: 1000, distance: 9.8, maxElevation: 4000, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "Sand Lake", location: "White Pass", elevationGain: 1500, distance: 4, maxElevation: 5200, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Round Mt.", location: "White Pass", elevationGain: 2000, distance: 8.8, maxElevation: 5970, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" }
            ],
            'east-slopes-north': [
                { name: "Slate Peak", location: "Methow Valley", elevationGain: 1500, distance: 4, maxElevation: 7440, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Delancy Ridge", location: "Methow Valley", elevationGain: 2500, distance: 4, maxElevation: 7000, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Mesahchie Peak", location: "Methow Valley", elevationGain: 5200, distance: 8, maxElevation: 8795, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Silver Star Mt", location: "Methow Valley", elevationGain: 5436, distance: 8, maxElevation: 8876, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Cutthroat Pass Alternative", location: "Methow Valley", elevationGain: 2000, distance: 10, maxElevation: 6800, aspect: "Multiple", terrain: "Open slopes, <30¬∞" },
                { name: "Cutthroat Pass", location: "Methow Valley", elevationGain: 2200, distance: 15.6, maxElevation: 6820, aspect: "Multiple", terrain: "Open slopes, <30¬∞" },
                { name: "Heather and Maple Pass", location: "Methow Valley", elevationGain: 4200, distance: 6.5, maxElevation: 7000, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Black Peak: South Face", location: "Methow Valley", elevationGain: 4630, distance: 10, maxElevation: 8970, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Washington Pass Birthday Tour", location: "Methow Valley", elevationGain: 3600, distance: 5, maxElevation: 6500, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Early Winters", location: "Methow Valley", elevationGain: 1800, distance: 4, maxElevation: 6200, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Loup Loup", location: "Methow Valley", elevationGain: 800, distance: 10, maxElevation: 4400, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "North Star Mt", location: "Methow Valley", elevationGain: 5500, distance: 26, maxElevation: 8300, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "Bonanza West Peak", location: "Methow Valley", elevationGain: 8300, distance: 30, maxElevation: 9511, aspect: "Multiple", terrain: "Exposed ridge, 40-45¬∞" }
            ],
            'olympics': [
                { name: "Lodge Run & Toilet Bowl", location: "Olympics", elevationGain: 500, distance: 1, maxElevation: 5200, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Mt. Angeles", location: "Olympics", elevationGain: 1500, distance: 2, maxElevation: 6454, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Mount Angeles with Klahhane Ridge", location: "Olympics", elevationGain: 4400, distance: 6, maxElevation: 6454, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Wolf Creek Trail", location: "Olympics", elevationGain: 1500, distance: 8.7, maxElevation: 5000, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Waterhole Trail", location: "Olympics", elevationGain: 1200, distance: 8, maxElevation: 4500, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Obstruction Point", location: "Olympics", elevationGain: 3500, distance: 16, maxElevation: 6450, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Hurricane Hill", location: "Olympics", elevationGain: 2000, distance: 6, maxElevation: 5757, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Second Peak", location: "Olympics", elevationGain: 2500, distance: 8, maxElevation: 5500, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Deer Park", location: "Olympics", elevationGain: 2500, distance: 14, maxElevation: 6007, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "High Divide", location: "Olympics", elevationGain: 4000, distance: 17, maxElevation: 5500, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Potholes", location: "Olympics", elevationGain: 2500, distance: 10, maxElevation: 5000, aspect: "Multiple", terrain: "Open slopes, 30-35¬∞" },
                { name: "Mt Ellinor", location: "Olympics", elevationGain: 3280, distance: 8, maxElevation: 5944, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Olympic Hot Springs", location: "Olympics", elevationGain: 1000, distance: 7.6, maxElevation: 3000, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "Mount Deception", location: "Olympics", elevationGain: 5000, distance: 16, maxElevation: 7788, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" },
                { name: "The Brothers: East Basin", location: "Olympics", elevationGain: 6740, distance: 12, maxElevation: 6866, aspect: "Multiple", terrain: "Exposed ridge, 35-40¬∞" }
            ],
            'mt-hood': [
                { name: "Mt. Adams", location: "Mt Adams", elevationGain: 6756, distance: 10, maxElevation: 12276, aspect: "Multiple", terrain: "Glacier travel" },
                { name: "Mt Saint Helens", location: "Mt St Helens", elevationGain: 5665, distance: 8, maxElevation: 8363, aspect: "Multiple", terrain: "Open slopes, 35-40¬∞" },
                { name: "Marble Mt.", location: "Mt St Helens", elevationGain: 1500, distance: 12, maxElevation: 4128, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "June Lake", location: "Mt St Helens", elevationGain: 1500, distance: 4.8, maxElevation: 4200, aspect: "Multiple", terrain: "Treed, <30¬∞" },
                { name: "Aiken Lava Bed", location: "Mt Adams", elevationGain: 1200, distance: 7.6, maxElevation: 4000, aspect: "Multiple", terrain: "Treed, <25¬∞" },
                { name: "Mt Adams: North Face", location: "Mt Adams", elevationGain: 8970, distance: 16, maxElevation: 12276, aspect: "Multiple", terrain: "Exposed ridge, 40-45¬∞" }
            ],
        };

        const fitnessLabels = {
            1: 'Exhausted', 2: 'Very Tired', 3: 'Tired', 4: 'Below Average',
            5: 'Average', 6: 'Good', 7: 'Strong', 8: 'Very Strong',
            9: 'Excellent', 10: 'Peak Energy'
        };

        const skillLabels = {
            1: 'First Timer', 2: 'Novice', 3: 'Beginner', 4: 'Developing',
            5: 'Intermediate', 6: 'Competent', 7: 'Advanced', 8: 'Expert',
            9: 'Very Expert', 10: 'Professional Guide'
        };

        const skillDescriptions = {
            1: 'New to backcountry skiing. Stick to groomed sidecountry or guided tours.',
            2: 'Learning basics. Need easy, well-traveled routes with low avalanche terrain.',
            3: 'Know the basics. Can handle mellow terrain, needs mentorship on longer tours.',
            4: 'Building skills. Comfortable skinning, learning avalanche assessment.',
            5: 'Can handle moderate terrain, some route-finding, comfortable with avalanche basics.',
            6: 'Solid skills. Can plan tours, read terrain, make good decisions in variable conditions.',
            7: 'Strong all-around. Handles complex terrain, glacier travel, leads groups safely.',
            8: 'Expert level. Comfortable in steep couloirs, technical terrain, alpine starts.',
            9: 'Highly skilled. Multi-day traverses, extreme terrain, rescue leadership.',
            10: 'Professional guide level. Certified, can handle any objective safely.'
        };

        function onZoneChange() {
            const nwacZone = document.getElementById('nwacZone').value;
            console.log('üîÑ onZoneChange called, zone:', nwacZone);
            
            const welcomeEl = document.getElementById('welcomeMessage');
            const dashboardEl = document.getElementById('dashboardContent');
            
            console.log('üìã Welcome element:', welcomeEl);
            console.log('üìã Dashboard element:', dashboardEl);
            
            if (!nwacZone) {
                console.log('‚ùå No zone selected, showing welcome');
                if (welcomeEl) welcomeEl.style.display = 'block';
                if (dashboardEl) dashboardEl.style.display = 'none';
                return;
            }
            
            console.log('‚úÖ Zone selected:', nwacZone);
            console.log('üìã Hiding welcome, showing dashboard...');
            
            if (welcomeEl) {
                welcomeEl.style.display = 'none';
                console.log('üìã Welcome display now:', welcomeEl.style.display);
            }
            if (dashboardEl) {
                dashboardEl.style.display = 'block';
                console.log('üìã Dashboard display now:', dashboardEl.style.display);
            }
            
            // Update config
            config.nwacZone = nwacZone;
            config.location = zoneDefaults[nwacZone];
            
            console.log('‚úÖ Config updated:', JSON.stringify(config));
            console.log('üìç Location set to:', config.location);
            
            // Load all data
            console.log('üìã Calling loadDashboard...');
            loadDashboard();
        }

        async function loadDashboard() {
            console.log('üìä loadDashboard() called');
            console.log('üìä Zone:', config.nwacZone);
            console.log('üìä Location:', config.location);
            
            // Update date
            console.log('üìä Calling updateDate...');
            updateDate();

            // Load all data
            console.log('üìä Loading avalanche, weather, and tours...');
            try {
                await Promise.all([
                    loadAvalancheForecast(),
                    loadWeatherData(),
                    loadTours()
                ]);
                console.log('‚úÖ All data loaded successfully!');
            } catch (error) {
                console.error('‚ùå Error loading data:', error);
                console.error('‚ùå Error stack:', error.stack);
            }
        }

        function updateDate() {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('dateBanner').textContent = 
                `üìÖ Today: ${today.toLocaleDateString('en-US', options)}`;
        }

        async function loadAvalancheForecast() {
            const content = document.getElementById('avalancheContent');
            console.log('üèîÔ∏è Loading avalanche forecast for:', config.nwacZone);
            
            // NWAC zone URLs mapping
            const nwacZoneUrls = {
                'west-slopes-north': 'https://nwac.us/avalanche-forecast/#/west-slopes-north',
                'stevens-pass': 'https://nwac.us/avalanche-forecast/#/stevens-pass',
                'west-slopes-central': 'https://nwac.us/avalanche-forecast/#/west-slopes-central',
                'snoqualmie-pass': 'https://nwac.us/avalanche-forecast/#/snoqualmie-pass',
                'west-slopes-south': 'https://nwac.us/avalanche-forecast/#/west-slopes-south',
                'east-slopes-north': 'https://nwac.us/avalanche-forecast/#/east-slopes-north',
                'east-slopes-central': 'https://nwac.us/avalanche-forecast/#/east-slopes-central',
                'east-slopes-south': 'https://nwac.us/avalanche-forecast/#/east-slopes-south',
                'olympics': 'https://nwac.us/avalanche-forecast/#/olympics',
                'mt-hood': 'https://nwac.us/avalanche-forecast/#/mt-hood'
            };
            
            // Map our zone IDs to avalanche.org zone IDs
            const avyOrgZoneIds = {
                'west-slopes-north': 1129,      // Mt Baker
                'stevens-pass': 1130,           // Stevens Pass
                'west-slopes-central': 1131,    // West Central
                'snoqualmie-pass': 1132,        // Snoqualmie Pass
                'west-slopes-south': 1133,      // West South
                'east-slopes-north': 1134,      // East North
                'east-slopes-central': 1135,    // East Central
                'east-slopes-south': 1136,      // East South
                'olympics': 1137,               // Olympics
                'mt-hood': 1138                 // Mt Hood
            };
            
            const zoneUrl = nwacZoneUrls[config.nwacZone] || 'https://nwac.us/avalanche-forecast/';
            const zoneName = getZoneName(config.nwacZone);
            
            // Danger level colors and labels
            const dangerColors = {
                0: { color: '#cccccc', label: 'No Rating', textColor: '#333' },
                1: { color: '#50B848', label: 'Low', textColor: '#fff' },
                2: { color: '#FFF200', label: 'Moderate', textColor: '#333' },
                3: { color: '#F7941E', label: 'Considerable', textColor: '#fff' },
                4: { color: '#ED1C24', label: 'High', textColor: '#fff' },
                5: { color: '#000000', label: 'Extreme', textColor: '#fff' }
            };
            
            // Show loading state
            content.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üèîÔ∏è</div>
                    <div style="color: var(--topo-gray);">Loading avalanche forecast...</div>
                </div>
            `;
            
            try {
                // Try to fetch from avalanche.org API
                const apiUrl = 'https://api.avalanche.org/v2/public/products?avalanche_center_id=NWAC&type=forecast';
                console.log('üèîÔ∏è Fetching from avalanche.org API:', apiUrl);
                
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`API returned ${response.status}`);
                }
                
                const forecasts = await response.json();
                console.log('üèîÔ∏è Avalanche.org API response:', forecasts);
                
                // Find the forecast for our zone
                const zoneId = avyOrgZoneIds[config.nwacZone];
                let forecast = null;
                
                if (forecasts && Array.isArray(forecasts)) {
                    forecast = forecasts.find(f => f.forecast_zone && f.forecast_zone.some(z => z.id === zoneId));
                }
                
                if (forecast) {
                    // Parse danger levels
                    const dangerAbove = forecast.danger ? forecast.danger.find(d => d.upper !== undefined)?.upper || 0 : 0;
                    const dangerNear = forecast.danger ? forecast.danger.find(d => d.middle !== undefined)?.middle || 0 : 0;
                    const dangerBelow = forecast.danger ? forecast.danger.find(d => d.lower !== undefined)?.lower || 0 : 0;
                    
                    // Get the highest danger for display
                    const maxDanger = Math.max(dangerAbove, dangerNear, dangerBelow);
                    const dangerInfo = dangerColors[maxDanger] || dangerColors[0];
                    
                    // Parse avalanche problems
                    const problems = forecast.forecast_avalanche_problems || [];
                    
                    // Parse bottom line
                    const bottomLine = forecast.bottom_line || '';
                    
                    // Issue date
                    const issueDate = forecast.published_time ? new Date(forecast.published_time).toLocaleDateString('en-US', {
                        weekday: 'short', month: 'short', day: 'numeric', hour: 'numeric', minute: '2-digit'
                    }) : '';
                    
                    content.innerHTML = `
                        <div style="text-align: center;">
                            <!-- Zone Name & Issue Date -->
                            <div style="margin-bottom: 1rem;">
                                <div style="font-size: 1.1rem; font-weight: 700; color: var(--forest-green);">
                                    ${zoneName}
                                </div>
                                ${issueDate ? `<div style="font-size: 0.7rem; color: var(--topo-gray);">Updated: ${issueDate}</div>` : ''}
                            </div>
                            
                            <!-- Danger Rating Display -->
                            <div style="background: ${dangerInfo.color}; color: ${dangerInfo.textColor}; padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
                                <div style="font-size: 0.7rem; text-transform: uppercase; opacity: 0.9; margin-bottom: 0.25rem;">Current Danger</div>
                                <div style="font-size: 1.75rem; font-weight: 700;">${dangerInfo.label}</div>
                            </div>
                            
                            <!-- Elevation Breakdown -->
                            <div style="display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
                                <div style="background: ${dangerColors[dangerAbove].color}; color: ${dangerColors[dangerAbove].textColor}; padding: 0.5rem 0.75rem; border-radius: 8px; min-width: 80px;">
                                    <div style="font-size: 0.6rem; text-transform: uppercase; opacity: 0.8;">Above TL</div>
                                    <div style="font-size: 0.85rem; font-weight: 700;">${dangerColors[dangerAbove].label}</div>
                                </div>
                                <div style="background: ${dangerColors[dangerNear].color}; color: ${dangerColors[dangerNear].textColor}; padding: 0.5rem 0.75rem; border-radius: 8px; min-width: 80px;">
                                    <div style="font-size: 0.6rem; text-transform: uppercase; opacity: 0.8;">Near TL</div>
                                    <div style="font-size: 0.85rem; font-weight: 700;">${dangerColors[dangerNear].label}</div>
                                </div>
                                <div style="background: ${dangerColors[dangerBelow].color}; color: ${dangerColors[dangerBelow].textColor}; padding: 0.5rem 0.75rem; border-radius: 8px; min-width: 80px;">
                                    <div style="font-size: 0.6rem; text-transform: uppercase; opacity: 0.8;">Below TL</div>
                                    <div style="font-size: 0.85rem; font-weight: 700;">${dangerColors[dangerBelow].label}</div>
                                </div>
                            </div>
                            
                            <!-- Avalanche Problems -->
                            ${problems.length > 0 ? `
                            <div style="background: var(--cream); border-radius: 10px; padding: 0.75rem; margin-bottom: 1rem; text-align: left;">
                                <div style="font-size: 0.7rem; color: var(--topo-gray); text-transform: uppercase; margin-bottom: 0.5rem;">Avalanche Problems</div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.4rem;">
                                    ${problems.map(p => `
                                        <span style="background: #e8e8e8; padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 0.75rem; font-weight: 600;">
                                            ${p.name || p.avalanche_problem_id || 'Unknown'}
                                        </span>
                                    `).join('')}
                                </div>
                            </div>
                            ` : ''}
                            
                            <!-- Bottom Line Summary -->
                            ${bottomLine ? `
                            <div style="background: var(--cream); border-radius: 10px; padding: 0.75rem; margin-bottom: 1rem; text-align: left;">
                                <div style="font-size: 0.7rem; color: var(--topo-gray); text-transform: uppercase; margin-bottom: 0.4rem;">Bottom Line</div>
                                <div style="font-size: 0.8rem; color: #333; line-height: 1.4;">${bottomLine.replace(/<[^>]*>/g, '').substring(0, 300)}${bottomLine.length > 300 ? '...' : ''}</div>
                            </div>
                            ` : ''}
                            
                            <!-- CTA Button -->
                            <a href="${zoneUrl}" target="_blank" 
                               style="display: inline-block; background: var(--forest-green); color: white; 
                                      padding: 0.75rem 1.5rem; border-radius: 8px; text-decoration: none; 
                                      font-weight: 700; font-size: 0.9rem; margin-bottom: 0.75rem;
                                      box-shadow: 0 4px 12px rgba(45, 80, 45, 0.3);">
                                üèîÔ∏è Full Forecast ‚Üí
                            </a>
                            
                            <!-- Quick Links -->
                            <div style="display: flex; gap: 0.75rem; justify-content: center; flex-wrap: wrap;">
                                <a href="https://nwac.us/observations/" target="_blank" 
                                   style="color: var(--forest-green); font-size: 0.75rem; text-decoration: none;">
                                    üëÅÔ∏è Observations
                                </a>
                                <a href="https://nwac.us/weatherdata/" target="_blank" 
                                   style="color: var(--forest-green); font-size: 0.75rem; text-decoration: none;">
                                    üå°Ô∏è Weather Stations
                                </a>
                            </div>
                        </div>
                    `;
                    console.log('‚úÖ Avalanche forecast loaded from API for zone:', config.nwacZone);
                } else {
                    throw new Error('Zone forecast not found in API response');
                }
                
            } catch (error) {
                console.warn('‚ö†Ô∏è Avalanche API failed, showing fallback:', error.message);
                
                // Fallback to static display with link
                content.innerHTML = `
                    <div style="text-align: center;">
                        <!-- Zone Name -->
                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--forest-green); margin-bottom: 1rem;">
                            ${zoneName}
                        </div>
                        
                        <!-- Danger Scale Legend -->
                        <div style="background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%); border-radius: 12px; padding: 1rem; margin-bottom: 1rem;">
                            <div style="font-size: 0.7rem; color: var(--topo-gray); text-transform: uppercase; margin-bottom: 0.5rem;">
                                Danger Scale
                            </div>
                            <div style="display: flex; justify-content: center; gap: 0.4rem; flex-wrap: wrap;">
                                <div style="display: flex; align-items: center; gap: 0.2rem; background: white; padding: 0.3rem 0.5rem; border-radius: 5px;">
                                    <div style="width: 14px; height: 14px; border-radius: 50%; background: #50B848;"></div>
                                    <span style="font-size: 0.65rem; font-weight: 600;">Low</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 0.2rem; background: white; padding: 0.3rem 0.5rem; border-radius: 5px;">
                                    <div style="width: 14px; height: 14px; border-radius: 50%; background: #FFF200; border: 1px solid #ddd;"></div>
                                    <span style="font-size: 0.65rem; font-weight: 600;">Mod</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 0.2rem; background: white; padding: 0.3rem 0.5rem; border-radius: 5px;">
                                    <div style="width: 14px; height: 14px; border-radius: 50%; background: #F7941E;"></div>
                                    <span style="font-size: 0.65rem; font-weight: 600;">Cons</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 0.2rem; background: white; padding: 0.3rem 0.5rem; border-radius: 5px;">
                                    <div style="width: 14px; height: 14px; border-radius: 50%; background: #ED1C24;"></div>
                                    <span style="font-size: 0.65rem; font-weight: 600;">High</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 0.2rem; background: white; padding: 0.3rem 0.5rem; border-radius: 5px;">
                                    <div style="width: 14px; height: 14px; border-radius: 50%; background: #000000;"></div>
                                    <span style="font-size: 0.65rem; font-weight: 600;">Ext</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Warning -->
                        <div style="background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; padding: 0.75rem; margin-bottom: 1rem;">
                            <div style="font-size: 0.8rem; color: #856404;">
                                ‚ö†Ô∏è <strong>Check NWAC for current conditions</strong>
                            </div>
                        </div>
                        
                        <!-- CTA Button -->
                        <a href="${zoneUrl}" target="_blank" 
                           style="display: inline-block; background: var(--forest-green); color: white; 
                                  padding: 1rem 2rem; border-radius: 10px; text-decoration: none; 
                                  font-weight: 700; font-size: 1rem; margin-bottom: 0.75rem;
                                  box-shadow: 0 4px 12px rgba(45, 80, 45, 0.3);">
                            üèîÔ∏è View Forecast
                        </a>
                        
                        <!-- Quick Links -->
                        <div style="display: flex; gap: 0.75rem; justify-content: center; flex-wrap: wrap;">
                            <a href="https://nwac.us/avalanche-forecast/" target="_blank" 
                               style="color: var(--forest-green); font-size: 0.75rem; text-decoration: none;">
                                üìç All Zones
                            </a>
                            <a href="https://nwac.us/observations/" target="_blank" 
                               style="color: var(--forest-green); font-size: 0.75rem; text-decoration: none;">
                                üëÅÔ∏è Observations
                            </a>
                        </div>
                    </div>
                `;
            }
        }

        // ============================================
        // SYNOPTIC DATA API CONFIGURATION
        // Sign up at: https://customer.synopticdata.com/signup
        // Free tier: 5,000 requests/month
        // ============================================
        const SYNOPTIC_TOKEN = 'f26f2eb1c2c04cef95b94b2405949325';
        
        // Zone center coordinates for Synoptic radius search
        const zoneCoordinates = {
            'west-slopes-north': { lat: 48.85, lon: -121.68, name: 'Mt Baker Area' },
            'stevens-pass': { lat: 47.745, lon: -121.089, name: 'Stevens Pass' },
            'west-slopes-central': { lat: 47.50, lon: -121.40, name: 'Central Cascades' },
            'snoqualmie-pass': { lat: 47.40, lon: -121.40, name: 'Snoqualmie Pass' },
            'west-slopes-south': { lat: 46.85, lon: -121.75, name: 'Paradise/Rainier' },
            'east-slopes-north': { lat: 48.50, lon: -120.50, name: 'East North Cascades' },
            'east-slopes-central': { lat: 47.30, lon: -120.60, name: 'Mission Ridge Area' },
            'east-slopes-south': { lat: 46.60, lon: -121.00, name: 'East South Cascades' },
            'olympics': { lat: 47.80, lon: -123.50, name: 'Olympics' },
            'mt-hood': { lat: 45.37, lon: -121.70, name: 'Mt Hood' }
        };

        async function loadWeatherData() {
            const content = document.getElementById('weatherContent');
            console.log('‚õÖ Loading weather data for:', config.location);
            
            const zoneInfo = zoneCoordinates[config.nwacZone] || zoneCoordinates['stevens-pass'];
            
            try {
                // ============================================
                // ALL WEATHER DATA FROM NATIONAL WEATHER SERVICE
                // ============================================
                const pointsUrl = `https://api.weather.gov/points/${config.location.lat},${config.location.lon}`;
                const pointsResponse = await fetch(pointsUrl);
                
                if (!pointsResponse.ok) {
                    throw new Error(`Weather.gov returned ${pointsResponse.status}`);
                }
                
                const pointsData = await pointsResponse.json();
                const forecastUrl = pointsData.properties.forecast;
                const forecastResponse = await fetch(forecastUrl);
                
                if (!forecastResponse.ok) {
                    throw new Error(`Forecast request returned ${forecastResponse.status}`);
                }
                
                const forecastData = await forecastResponse.json();
                const current = forecastData.properties.periods[0];
                const temp = current.temperature;
                const windSpeed = current.windSpeed;
                
                console.log('‚úÖ NWS Weather loaded:', { temp, windSpeed, conditions: current.shortForecast });
                
                // ============================================
                // SNOW DATA FROM SYNOPTIC DATA API
                // (Same data source as OpenSnow!)
                // ============================================
                let snowDepth = '--';
                let newSnow24h = '--';
                let newSnow7d = '--';
                let stationName = '';
                let stationElevation = '';
                let synopticWorking = false;
                
                if (SYNOPTIC_TOKEN !== 'YOUR_SYNOPTIC_TOKEN') {
                    try {
                        // Search for SNOTEL stations (network 2) which have snow data
                        // Also include other networks that report snow
                        const synopticUrl = `https://api.synopticdata.com/v2/stations/latest?` +
                            `token=${SYNOPTIC_TOKEN}` +
                            `&radius=${zoneInfo.lat},${zoneInfo.lon},50` +  // 50 mile radius
                            `&vars=snow_depth,snow_water_equiv,precip_accum_24_hour` +
                            `&within=1440` +  // Data within last 24 hours
                            `&units=english` +
                            `&status=active`;
                        
                        console.log('‚ùÑÔ∏è Fetching Synoptic snow data for:', zoneInfo.name);
                        console.log('‚ùÑÔ∏è API URL:', synopticUrl);
                        const synopticResponse = await fetch(synopticUrl);
                        
                        if (synopticResponse.ok) {
                            const synopticData = await synopticResponse.json();
                            console.log('‚ùÑÔ∏è Synoptic API response:', synopticData);
                            
                            // Check for API errors
                            if (synopticData.SUMMARY && synopticData.SUMMARY.RESPONSE_CODE === 1) {
                                console.log('‚ùÑÔ∏è Found', synopticData.SUMMARY.NUMBER_OF_OBJECTS, 'stations');
                            }
                            
                            if (synopticData.STATION && synopticData.STATION.length > 0) {
                                // Find station with best snow data (prefer higher elevation)
                                let bestStation = null;
                                let bestElevation = 0;
                                
                                synopticData.STATION.forEach(station => {
                                    const elev = parseFloat(station.ELEVATION) || 0;
                                    const obs = station.OBSERVATIONS || {};
                                    
                                    // Check for any snow-related data
                                    const hasSnowData = obs.snow_depth_value_1 || 
                                                       obs.snow_water_equiv_value_1 ||
                                                       obs.precip_accum_24_hour_value_1;
                                    
                                    console.log(`‚ùÑÔ∏è Station: ${station.NAME} (${elev} ft) - Has snow data: ${!!hasSnowData}`);
                                    
                                    if (hasSnowData && elev > bestElevation) {
                                        bestStation = station;
                                        bestElevation = elev;
                                    }
                                });
                                
                                // If no snow data stations, just get highest elevation station
                                if (!bestStation && synopticData.STATION.length > 0) {
                                    synopticData.STATION.forEach(station => {
                                        const elev = parseFloat(station.ELEVATION) || 0;
                                        if (elev > bestElevation) {
                                            bestStation = station;
                                            bestElevation = elev;
                                        }
                                    });
                                }
                                
                                if (bestStation) {
                                    stationName = bestStation.NAME || bestStation.STID;
                                    stationElevation = Math.round(bestElevation) + ' ft';
                                    synopticWorking = true;
                                    
                                    const obs = bestStation.OBSERVATIONS || {};
                                    console.log('‚ùÑÔ∏è Best station observations:', obs);
                                    
                                    // Snow depth (inches) - try multiple possible keys
                                    if (obs.snow_depth_value_1?.value !== undefined && obs.snow_depth_value_1?.value !== null) {
                                        snowDepth = Math.round(obs.snow_depth_value_1.value) + '"';
                                    }
                                    
                                    // Snow water equivalent
                                    if (obs.snow_water_equiv_value_1?.value !== undefined && obs.snow_water_equiv_value_1?.value !== null) {
                                        // SWE in inches, estimate snow depth with 10:1 ratio if no direct depth
                                        if (snowDepth === '--') {
                                            snowDepth = Math.round(obs.snow_water_equiv_value_1.value * 10) + '"*';
                                        }
                                        newSnow7d = obs.snow_water_equiv_value_1.value.toFixed(1) + '" SWE';
                                    }
                                    
                                    // 24-hour precip (convert to estimated snowfall)
                                    if (obs.precip_accum_24_hour_value_1?.value !== undefined && obs.precip_accum_24_hour_value_1?.value !== null) {
                                        const precip = obs.precip_accum_24_hour_value_1.value;
                                        // Estimate snow from liquid precip (10:1 ratio for Cascades)
                                        newSnow24h = Math.round(precip * 10) + '"';
                                    }
                                    
                                    console.log('‚úÖ Synoptic snow data:', { stationName, stationElevation, snowDepth, newSnow24h, newSnow7d });
                                }
                            } else {
                                console.log('‚ùÑÔ∏è No stations found in response');
                            }
                        } else {
                            console.warn('‚ùÑÔ∏è Synoptic API returned status:', synopticResponse.status);
                        }
                    } catch (synopticErr) {
                        console.warn('‚ùÑÔ∏è Synoptic fetch failed:', synopticErr.message);
                    }
                } else {
                    console.log('‚ÑπÔ∏è Synoptic token not configured - using placeholder display');
                }
                
                // ============================================
                // RENDER WEATHER DISPLAY
                // ============================================
                content.innerHTML = `
                    <div style="text-align: center; padding: 0.5rem 0;">
                        <!-- Temperature from NWS -->
                        <div style="margin-bottom: 1.25rem;">
                            <div style="font-size: 3rem; font-weight: 700; color: var(--forest-green); line-height: 1;">
                                ${temp}¬∞<span style="font-size: 1.25rem;">F</span>
                            </div>
                            <div style="font-size: 1rem; color: var(--topo-gray); margin-top: 0.4rem;">
                                ${current.shortForecast}
                            </div>
                        </div>
                        
                        <!-- Weather stats from NWS -->
                        <div style="display: flex; justify-content: center; gap: 1.5rem; margin-bottom: 1.25rem; flex-wrap: wrap;">
                            <div style="text-align: center; background: var(--cream); padding: 0.6rem 1rem; border-radius: 8px;">
                                <div style="font-size: 0.65rem; color: var(--topo-gray); text-transform: uppercase;">Wind</div>
                                <div style="font-size: 1rem; font-weight: 600; color: var(--forest-green);">üí® ${windSpeed}</div>
                            </div>
                            <div style="text-align: center; background: var(--cream); padding: 0.6rem 1rem; border-radius: 8px;">
                                <div style="font-size: 0.65rem; color: var(--topo-gray); text-transform: uppercase;">${current.isDaytime ? 'Daytime' : 'Nighttime'}</div>
                                <div style="font-size: 1rem; font-weight: 600; color: var(--forest-green);">${current.isDaytime ? '‚òÄÔ∏è Day' : 'üåô Night'}</div>
                            </div>
                        </div>
                        
                        <!-- Snow Data from Synoptic (OpenSnow's data source) -->
                        <div style="background: linear-gradient(135deg, #e8f4fd 0%, #d4e9f7 100%); border-radius: 10px; padding: 1rem; margin-bottom: 1rem;">
                            <div style="font-size: 0.7rem; color: #1565c0; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.5rem;">
                                ‚ùÑÔ∏è Snow Conditions
                            </div>
                            <div style="display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
                                <div style="text-align: center; min-width: 70px;">
                                    <div style="font-size: 1.4rem; font-weight: 700; color: #1565c0;">${snowDepth}</div>
                                    <div style="font-size: 0.65rem; color: var(--topo-gray);">Snow Depth</div>
                                </div>
                                <div style="text-align: center; min-width: 70px;">
                                    <div style="font-size: 1.4rem; font-weight: 700; color: #1565c0;">${newSnow24h}</div>
                                    <div style="font-size: 0.65rem; color: var(--topo-gray);">24hr New</div>
                                </div>
                                <div style="text-align: center; min-width: 70px;">
                                    <div style="font-size: 1.4rem; font-weight: 700; color: #1565c0;">${newSnow7d}</div>
                                    <div style="font-size: 0.65rem; color: var(--topo-gray);">SWE</div>
                                </div>
                            </div>
                            ${synopticWorking ? `
                            <div style="font-size: 0.7rem; color: var(--topo-gray); margin-top: 0.5rem;">
                                üìç ${stationName} (${stationElevation})
                            </div>
                            <div style="font-size: 0.6rem; color: var(--topo-gray); margin-top: 0.2rem; font-style: italic;">
                                Data via Synoptic ‚Ä¢ SWE = Snow Water Equivalent
                            </div>
                            ` : `
                            <div style="font-size: 0.7rem; color: #856404; margin-top: 0.5rem; background: #fff3cd; padding: 0.5rem; border-radius: 6px;">
                                ‚ö†Ô∏è Add your Synoptic token to enable live snow data
                                <br><a href="https://customer.synopticdata.com/signup" target="_blank" style="color: #1565c0;">Get free API access ‚Üí</a>
                            </div>
                            `}
                        </div>
                        
                        <!-- NWS Detailed Forecast -->
                        <div style="background: var(--cream); border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                            <div style="font-size: 0.7rem; color: var(--topo-gray); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.4rem;">
                                NWS Forecast
                            </div>
                            <div style="font-size: 0.85rem; color: #333; line-height: 1.5;">
                                ${current.detailedForecast}
                            </div>
                        </div>
                        
                        <!-- Data source links -->
                        <div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;">
                            <a href="https://opensnow.com/location/stevenspass" target="_blank" 
                               style="display: inline-flex; align-items: center; gap: 0.3rem; color: var(--forest-green); 
                                      font-size: 0.75rem; text-decoration: none; padding: 0.4rem 0.8rem; 
                                      background: var(--cream); border-radius: 6px;">
                                üéø OpenSnow
                            </a>
                            <a href="https://nwac.us/weatherdata/" target="_blank" 
                               style="display: inline-flex; align-items: center; gap: 0.3rem; color: var(--forest-green); 
                                      font-size: 0.75rem; text-decoration: none; padding: 0.4rem 0.8rem; 
                                      background: var(--cream); border-radius: 6px;">
                                üèîÔ∏è NWAC Stations
                            </a>
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('‚ùå Weather API failed:', error);
                content.innerHTML = `
                    <div style="text-align: center; padding: 2rem;">
                        <p style="color: var(--warning-red); font-size: 1.1rem; margin-bottom: 1rem;">
                            ‚ö†Ô∏è Unable to fetch weather from Weather.gov
                        </p>
                        <p style="font-size: 0.9rem; color: var(--topo-gray); margin-bottom: 1rem;">
                            Error: ${error.message}
                        </p>
                        <p style="font-size: 0.85rem; color: var(--topo-gray);">
                            Check <a href="https://www.weather.gov/" target="_blank" style="color: var(--forest-green);">Weather.gov</a> or 
                            <a href="https://www.mountain-forecast.com/" target="_blank" style="color: var(--forest-green);">Mountain-Forecast.com</a>
                        </p>
                    </div>
                `;
            }
        }

        async function loadTours() {
            const content = document.getElementById('toursContent');
            console.log('üìç Loading tours for zone:', config.nwacZone, 'with fitness:', config.fitnessLevel, 'skill:', config.skillLevel);
            
            const zoneName = getZoneName(config.nwacZone);
            
            // Update the sort message
            document.getElementById('toursSortMessage').innerHTML = `
                üí° Showing <strong>top 5 tours</strong> for <strong>${zoneName}</strong> based on:
                <br>Energy: <strong>${fitnessLabels[config.fitnessLevel]}</strong> (${config.fitnessLevel}/10) ‚Ä¢ 
                Skill: <strong>${skillLabels[config.skillLevel]}</strong> (${config.skillLevel}/10)
            `;
            
            const tours = toursByZone[config.nwacZone] || [];
            
            if (tours.length === 0) {
                content.innerHTML = `
                    <div class="tour-card">
                        <div style="text-align: center; padding: 2rem;">
                            <p style="font-size: 1.1rem; color: var(--topo-gray); margin-bottom: 1rem;">
                                No sample tours available for this zone yet.
                            </p>
                            <p style="font-size: 0.9rem; color: var(--topo-gray);">
                                Add your own tours by editing the <code>toursByZone</code> object!
                            </p>
                        </div>
                    </div>
                `;
                return;
            }
            
            console.log(`‚úÖ Loaded ${tours.length} tours for ${config.nwacZone} - Calculating recommendations with fitness ${config.fitnessLevel}/10`);
            
            // Calculate recommendations for all tours
            const toursWithRecs = tours.map((tour) => {
                const rec = calculateRecommendation(tour);
                return { tour, rec };
            });
            
            // Sort by recommendation score (highest first)
            toursWithRecs.sort((a, b) => b.rec.score - a.rec.score);
            
            // Take only top 5
            const topTours = toursWithRecs.slice(0, 5);
            
            console.log('üìä Top 5 tours by score:', topTours.map(t => ({ 
                name: t.tour.name, 
                score: t.rec.score, 
                level: t.rec.level 
            })));
            
            // Generate HTML for top 5 tours
            content.innerHTML = topTours.map(({ tour, rec }, index) => {
                return generateTourCard(tour, rec, index + 1);
            }).join('');
            
            // Add note if there are more tours available
            if (tours.length > 5) {
                content.innerHTML += `
                    <div style="text-align: center; padding: 1.5rem; color: var(--topo-gray); font-size: 0.9rem;">
                        <p>Showing top 5 of ${tours.length} tours. Add more tours to your zone for more options!</p>
                    </div>
                `;
            }
        }

        function calculateRecommendation(tour) {
            const fitness = config.fitnessLevel;
            const skill = config.skillLevel;
            const elevGain = tour.elevationGain;
            const distance = tour.distance;
            const terrain = tour.terrain.toLowerCase();
            const maxElev = tour.maxElevation;
            
            console.log(`üéØ Calculating for ${tour.name}:`, { fitness, skill, elevGain, distance });
            
            let score = 0;
            let warnings = [];
            let bonuses = [];
            
            // ============================================
            // TOUR DIFFICULTY RATING (1-10 scale)
            // ============================================
            
            // Physical difficulty based on elevation gain
            let physicalDifficulty = 1;
            if (elevGain < 1500) physicalDifficulty = 2;
            else if (elevGain < 2500) physicalDifficulty = 3;
            else if (elevGain < 3500) physicalDifficulty = 4;
            else if (elevGain < 4500) physicalDifficulty = 5;
            else if (elevGain < 6000) physicalDifficulty = 6;
            else if (elevGain < 8000) physicalDifficulty = 7;
            else if (elevGain < 10000) physicalDifficulty = 8;
            else if (elevGain < 15000) physicalDifficulty = 9;
            else physicalDifficulty = 10;
            
            // Adjust for distance (long flat tours are tiring too)
            if (distance > 15) physicalDifficulty = Math.min(10, physicalDifficulty + 1);
            if (distance > 25) physicalDifficulty = Math.min(10, physicalDifficulty + 1);
            
            // Technical difficulty based on terrain
            let technicalDifficulty = 3; // default moderate
            if (terrain.includes('treed') || terrain.includes('<25') || terrain.includes('<30')) {
                technicalDifficulty = 2;
            }
            if (terrain.includes('30-35')) technicalDifficulty = 4;
            if (terrain.includes('35-40')) technicalDifficulty = 5;
            if (terrain.includes('40-45') || terrain.includes('40-50')) technicalDifficulty = 7;
            if (terrain.includes('couloir')) technicalDifficulty = 8;
            if (terrain.includes('glacier')) technicalDifficulty = 7;
            if (terrain.includes('exposed')) technicalDifficulty = Math.min(10, technicalDifficulty + 1);
            
            // High elevation adds technical challenge
            if (maxElev > 8000) technicalDifficulty = Math.min(10, technicalDifficulty + 1);
            if (maxElev > 10000) technicalDifficulty = Math.min(10, technicalDifficulty + 1);
            
            console.log(`üìä ${tour.name}: Physical=${physicalDifficulty}, Technical=${technicalDifficulty}`);
            
            // ============================================
            // FITNESS MATCHING (physical capacity)
            // ============================================
            // Higher fitness = prefer HARDER physical tours
            
            const fitnessDiff = fitness - physicalDifficulty;
            
            if (fitness >= 8) {
                // Peak fitness - wants challenging tours
                if (physicalDifficulty >= 6) {
                    score += 4;  // Love a big day!
                    bonuses.push('Great physical challenge');
                } else if (physicalDifficulty >= 4) {
                    score += 2;  // Moderate is fine
                } else {
                    score += 0;  // Too easy, but acceptable
                }
            } else if (fitness >= 6) {
                // Good fitness - moderate to challenging
                if (physicalDifficulty >= 7) {
                    score += 1;  // Pushing it
                    warnings.push('Physically demanding for current energy');
                } else if (physicalDifficulty >= 4) {
                    score += 3;  // Sweet spot
                    bonuses.push('Good match for energy level');
                } else {
                    score += 2;  // Easy day is fine
                }
            } else if (fitness >= 4) {
                // Moderate fitness - prefer easier
                if (physicalDifficulty >= 6) {
                    score -= 2;  // Too hard
                    warnings.push('Tour is too physically demanding today');
                } else if (physicalDifficulty >= 4) {
                    score += 1;  // Doable
                } else {
                    score += 3;  // Good choice
                    bonuses.push('Appropriate for current energy');
                }
            } else {
                // Low fitness - easy tours only
                if (physicalDifficulty >= 4) {
                    score -= 3;  // Way too much
                    warnings.push('Rest recommended - tour exceeds current energy');
                } else if (physicalDifficulty >= 3) {
                    score -= 1;  // Pushing it
                    warnings.push('Consider a shorter option');
                } else {
                    score += 2;  // Manageable
                    bonuses.push('Low-key day within reach');
                }
            }
            
            // ============================================
            // SKILL MATCHING (technical ability)
            // ============================================
            // Higher skill = can handle more technical terrain
            
            const skillDiff = skill - technicalDifficulty;
            
            if (skill >= 8) {
                // Expert - wants technical terrain
                if (technicalDifficulty >= 7) {
                    score += 3;
                    bonuses.push('Challenging terrain you can handle');
                } else if (technicalDifficulty >= 5) {
                    score += 2;
                } else {
                    score += 1;  // Easy terrain is fine for recovery
                }
            } else if (skill >= 6) {
                // Competent - moderate technical
                if (technicalDifficulty >= 8) {
                    score -= 2;
                    warnings.push('Terrain exceeds current skill level');
                } else if (technicalDifficulty >= 6) {
                    score += 1;
                    warnings.push('Challenging terrain - stay alert');
                } else if (technicalDifficulty >= 4) {
                    score += 3;
                    bonuses.push('Good terrain match');
                } else {
                    score += 2;
                }
            } else if (skill >= 4) {
                // Developing - easier terrain
                if (technicalDifficulty >= 6) {
                    score -= 3;
                    warnings.push('Terrain too technical - gain more experience first');
                } else if (technicalDifficulty >= 4) {
                    score += 0;
                    warnings.push('At the edge of your comfort zone');
                } else {
                    score += 3;
                    bonuses.push('Good terrain for skill building');
                }
            } else {
                // Beginner - stick to easy terrain
                if (technicalDifficulty >= 4) {
                    score -= 4;
                    warnings.push('Not appropriate for skill level - need easier terrain');
                } else if (technicalDifficulty >= 3) {
                    score -= 1;
                    warnings.push('Go with experienced partners');
                } else {
                    score += 2;
                    bonuses.push('Appropriate for learning');
                }
            }
            
            // ============================================
            // SPECIAL TERRAIN WARNINGS
            // ============================================
            
            if (terrain.includes('glacier') && skill < 6) {
                score -= 2;
                warnings.push('Glacier travel requires crevasse rescue skills');
            }
            
            if (terrain.includes('couloir') && skill < 7) {
                score -= 2;
                warnings.push('Couloir skiing requires expert skills');
            }
            
            if (maxElev > 10000 && skill < 5) {
                score -= 1;
                warnings.push('High alpine environment - ensure proper preparation');
            }
            
            // Multi-day indicators
            if (elevGain > 10000 || distance > 30) {
                if (skill < 7 || fitness < 7) {
                    score -= 2;
                    warnings.push('Multi-day tour requires high fitness AND skill');
                }
            }
            
            console.log(`üìä Final score for ${tour.name}: ${score}`, { bonuses, warnings });
            
            // ============================================
            // GENERATE RECOMMENDATION
            // ============================================
            
            const analysisIntro = bonuses.length > 0 ? bonuses[0] + '. ' : '';
            const warningText = warnings.length > 0 ? warnings.join('. ') + '.' : '';
            
            if (score >= 4) {
                return { 
                    level: 'go', 
                    text: '‚úÖ Perfect Match', 
                    analysis: `${analysisIntro}This tour aligns well with your energy (${fitness}/10) and skill (${skill}/10). ${warningText || 'Enjoy!'}`,
                    score: score,
                    physicalDifficulty,
                    technicalDifficulty
                };
            } else if (score >= 2) {
                return { 
                    level: 'go', 
                    text: '‚úÖ Good to Go', 
                    analysis: `${analysisIntro}Solid choice for your current state. ${warningText || 'Have fun out there!'}`,
                    score: score,
                    physicalDifficulty,
                    technicalDifficulty
                };
            } else if (score >= 0) {
                return { 
                    level: 'maybe', 
                    text: '‚ö†Ô∏è Possible', 
                    analysis: `Doable but consider carefully. ${warningText || 'Be conservative with decisions.'}`,
                    score: score,
                    physicalDifficulty,
                    technicalDifficulty
                };
            } else if (score >= -2) {
                return { 
                    level: 'maybe', 
                    text: '‚ö†Ô∏è Stretch', 
                    analysis: `Pushing your limits today. ${warningText || 'Have a backup plan.'}`,
                    score: score,
                    physicalDifficulty,
                    technicalDifficulty
                };
            } else {
                return { 
                    level: 'no', 
                    text: 'üõë Not Today', 
                    analysis: `${warningText || 'This tour exceeds your current fitness or skill level.'} Consider a different objective.`,
                    score: score,
                    physicalDifficulty,
                    technicalDifficulty
                };
            }
        }

        function generateTourCard(tour, rec, rank = null) {
            const rankBadge = rank ? `<div style="display: inline-block; background: var(--burnt-orange); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-weight: 700; font-size: 0.85rem; margin-right: 0.5rem;">#${rank}</div>` : '';
            
            // Create difficulty bars
            const physBar = createDifficultyBar(rec.physicalDifficulty || 5, 'Physical');
            const techBar = createDifficultyBar(rec.technicalDifficulty || 5, 'Technical');
            
            return `
                <div class="tour-card">
                    <div class="tour-header">
                        <div>
                            <div class="tour-name">${rankBadge}${tour.name}</div>
                            <div class="tour-stats">
                                ${tour.location} ‚Ä¢ ${tour.elevationGain.toLocaleString()} ft gain ‚Ä¢ ${tour.distance} mi RT
                            </div>
                        </div>
                        <div class="recommendation rec-${rec.level}">${rec.text}</div>
                    </div>
                    <div class="tour-details">
                        <div class="detail-item">
                            <div class="detail-icon">üèîÔ∏è</div>
                            <div class="detail-text">
                                <span class="detail-label">Max Elevation</span>
                                <span class="detail-value">${tour.maxElevation.toLocaleString()} ft</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-icon">‚õ∞Ô∏è</div>
                            <div class="detail-text">
                                <span class="detail-label">Terrain</span>
                                <span class="detail-value">${tour.terrain}</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-icon">üí™</div>
                            <div class="detail-text">
                                <span class="detail-label">Physical</span>
                                ${physBar}
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-icon">üéø</div>
                            <div class="detail-text">
                                <span class="detail-label">Technical</span>
                                ${techBar}
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 1rem; margin-top: 1rem; padding: 0.75rem; background: var(--cream); border-radius: 6px; font-size: 0.85rem;">
                        <div><strong>Your Energy:</strong> ${config.fitnessLevel}/10</div>
                        <div><strong>Your Skill:</strong> ${config.skillLevel}/10</div>
                    </div>
                    <p style="margin-top: 1rem; color: var(--topo-gray); font-size: 0.9rem; line-height: 1.6;">
                        <strong>Analysis:</strong> ${rec.analysis}
                    </p>
                </div>
            `;
        }

        function createDifficultyBar(level, label) {
            const colors = ['#50B848', '#50B848', '#8BC34A', '#FFF200', '#FFC107', '#F7941E', '#FF5722', '#ED1C24', '#D32F2F', '#880E4F'];
            const color = colors[Math.min(level - 1, 9)];
            const width = level * 10;
            return `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <div style="flex: 1; height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden;">
                        <div style="width: ${width}%; height: 100%; background: ${color}; border-radius: 4px;"></div>
                    </div>
                    <span style="font-size: 0.8rem; font-weight: 600; color: ${color};">${level}/10</span>
                </div>
            `;
        }

        function getZoneName(zoneId) {
            const zones = {
                'west-slopes-north': 'West Slopes North (Mt Baker)',
                'stevens-pass': 'Stevens Pass',
                'west-slopes-central': 'West Slopes Central',
                'snoqualmie-pass': 'Snoqualmie Pass',
                'west-slopes-south': 'West Slopes South (White Pass)',
                'east-slopes-north': 'East Slopes North',
                'east-slopes-central': 'East Slopes Central (Mission Ridge)',
                'east-slopes-south': 'East Slopes South',
                'olympics': 'Olympics',
                'mt-hood': 'Mt Hood'
            };
            return zones[zoneId] || zoneId;
        }

        window.addEventListener('load', () => {
            // Always start fresh
            localStorage.removeItem('skiTourConfig');
            
            // Reset config to defaults
            config.fitnessLevel = 7;
            config.skillLevel = 5;
            config.nwacZone = null;
            config.location = null;
            
            // Reset zone selector
            document.getElementById('nwacZone').value = '';
            
            // Show welcome message, hide dashboard
            document.getElementById('welcomeMessage').style.display = 'block';
            document.getElementById('dashboardContent').style.display = 'none';
            
            // Set up slider event listeners
            const fitnessSlider = document.getElementById('fitnessSlider');
            const skillSlider = document.getElementById('skillSlider');
            
            if (fitnessSlider) {
                fitnessSlider.value = 7;
                document.getElementById('fitnessStatus').textContent = `${fitnessLabels[7]} (7/10)`;
                
                fitnessSlider.addEventListener('input', function() {
                    const value = parseInt(this.value);
                    config.fitnessLevel = value;
                    document.getElementById('fitnessStatus').textContent = 
                        `${fitnessLabels[value]} (${value}/10)`;
                    
                    console.log('üí™ Fitness level changed to:', value, '- Recalculating recommendations...');
                    if (config.nwacZone) loadTours();
                });
            }
            
            if (skillSlider) {
                skillSlider.value = 5;
                document.getElementById('skillStatus').textContent = `${skillLabels[5]} (5/10)`;
                document.getElementById('skillDescription').textContent = skillDescriptions[5];
                
                skillSlider.addEventListener('input', function() {
                    const value = parseInt(this.value);
                    config.skillLevel = value;
                    document.getElementById('skillStatus').textContent = 
                        `${skillLabels[value]} (${value}/10)`;
                    document.getElementById('skillDescription').textContent = skillDescriptions[value];
                    
                    console.log('üéø Skill level changed to:', value, '- Recalculating recommendations...');
                    if (config.nwacZone) loadTours();
                });
            }
            
            console.log('‚úÖ App initialized - ready for zone selection');
        });
    </script>
</body>
</html>
